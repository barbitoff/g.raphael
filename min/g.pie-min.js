(function(){function m(f,n,o,i,d,c){function m(d,a,g,c,b){var j=Math.PI/180,l=d+g*Math.cos(-c*j),i=d+g*Math.cos(-b*j),e=d+g/2*Math.cos(-(c+(b-c)/2)*j),f=a+g*Math.sin(-c*j),k=a+g*Math.sin(-b*j),j=a+g/2*Math.sin(-(c+(b-c)/2)*j),d=["M",d,a,"L",l,f,"A",g,g,0,+(180<Math.abs(b-c)),1,i,k,"z"];d.middle={x:e,y:j};return d}var c=c||{},u=this,v=[],s=f.set(),b=f.set(),p=f.set(),q=d.length,r=0,k=0,t=0,h=9,e=!0;b.covers=s;if(1==q)p.push(f.circle(n,o,i).attr({fill:c.colors&&c.colors[0]||u.colors[0],stroke:c.stroke||
"#fff","stroke-width":null==c.strokewidth?1:c.strokewidth})),s.push(f.circle(n,o,i).attr(u.shim)),k=d[0],d[0]={value:d[0],order:0,valueOf:function(){return this.value}},p[0].middle={x:n,y:o},p[0].mangle=180;else{for(var a=0;a<q;a++)k+=d[a],d[a]={value:d[a],order:a,valueOf:function(){return this.value}};d.sort(function(d,a){return a.value-d.value});for(a=0;a<q;a++)if(e&&1.5>=360*d[a]/k&&(h=a,e=!1),a>h)e=!1,d[h].value+=d[a],d[h].others=!0,t=d[h].value;q=Math.min(h+1,d.length);t&&d.splice(q)&&(d[h].others=
!0);for(a=0;a<q;a++){t=r-360*d[a]/k/2;a||(r=90-t,t=r-360*d[a]/k/2);if(c.init)var w=m(n,o,1,r,r-360*d[a]/k).join(",");h=m(n,o,i,r,r-=360*d[a]/k);e=f.path(c.init?w:h).attr({fill:c.colors&&c.colors[c.preserveColorOrder?d[a].order:a]||u.colors[a]||"#666",stroke:c.stroke||"#fff","stroke-width":null==c.strokewidth?1:c.strokewidth,"stroke-linejoin":"round"});e.value=d[a];e.middle=h.middle;e.mangle=t;v.push(e);p.push(e);c.init&&e.animate({path:h.join(",")},+c.init-1||1E3,">")}for(a=0;a<q;a++)e=f.path(v[a].attr("path")).attr(u.shim),
c.href&&c.href[a]&&e.attr({href:c.href[a]}),e.attr=function(){},s.push(e),p.push(e)}b.hover=function(a,c){for(var c=c||function(){},g=this,b=0;b<q;b++)(function(b,j,e){var f={sector:b,cover:j,cx:n,cy:o,mx:b.middle.x,my:b.middle.y,mangle:b.mangle,r:i,value:d[e],total:k,label:g.labels&&g.labels[e]};j.mouseover(function(){a.call(f)}).mouseout(function(){c.call(f)})})(p[b],s[b],b);return this};b.each=function(a){for(var c=0;c<q;c++){var b=p[c];a.call({sector:b,cover:s[c],cx:n,cy:o,x:b.middle.x,y:b.middle.y,
mangle:b.mangle,r:i,value:d[c],total:k,label:this.labels&&this.labels[c]})}return this};b.click=function(c){for(var a=this,b=0;b<q;b++)(function(b,e,f){var g={sector:b,cover:e,cx:n,cy:o,mx:b.middle.x,my:b.middle.y,mangle:b.mangle,r:i,value:d[f],total:k,label:a.labels&&a.labels[f]};e.click(function(){c.call(g)})})(p[b],s[b],b);return this};b.inject=function(b){b.insertBefore(s[0])};c.legend&&function(a,e,g,h){var r=n+i+i/5,j=o+10,a=a||[],h=h&&h.toLowerCase&&h.toLowerCase()||"east",g=f[g&&g.toLowerCase()]||
"circle";b.labels=f.set();for(var l=0;l<q;l++){var t=p[l].attr("fill"),m=d[l].order;d[l].others&&(a[m]=e||"Others");a[m]=u.labelise(a[m],d[l],k);b.labels.push(f.set());b.labels[l].push(f[g](r+5,j,5).attr({fill:t,stroke:"none"}));b.labels[l].push(t=f.text(r+20,j,a[m]||d[m]).attr(u.txtattr).attr({fill:c.legendcolor||"#000","text-anchor":"start"}));s[l].label=b.labels[l];j+=1.2*t.getBBox(!0).height}a=b.labels.getBBox(!0);b.labels.translate.apply(b.labels,{east:[0,-a.height/2],west:[-a.width-2*i-20,-a.height/
2],north:[-i-a.width/2,-i-a.height-10],south:[-i-a.width/2,i+10]}[h]);b.push(b.labels)}(c.legend,c.legendothers,c.legendmark,c.legendpos);b.push(p,s);b.series=p;b.covers=s;return b}var v=function(){};v.prototype=Raphael.g;m.prototype=new v;Raphael.fn.piechart=function(f,n,o,i,d){return new m(this,f,n,o,i,d)}})();
